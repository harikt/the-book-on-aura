<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="author" content="Hari KT, Paul M Jones" />
    <meta name="date" content="07/08/2013"/>
    <meta name="generator" content="easybook 5.0-DEV"/>

    <title>Creating Forms | The complete reference for Aura</title>

    <link rel="stylesheet" href="./css/easybook.css" />

</head>

<body class="item chapter">
<div class="container">
<div class="menu">
    <div class="row">
        <h1 class="span9"><a href="./index.html">The complete reference for Aura</a></h1>
        <p class="span3">
                        <a href="./chapter-12.html"><span>&larr;</span> Previous</a>
            
                        <a class="disabled" href="#">Next <span>&rarr;</span></a>
                    </p>
    </div>
</div>

<div class="row">
    <div class="span9">
        <h1 id="creating-forms"><span>Chapter 13</span> Creating Forms</h1>
        <p>Every webpage needs some sort of forms. Please do read chapter-5 
( Dependency Injection ) and chapter-6 ( Generic Factory ).</p>

<h2 id="form-class">13.1 Form class</h2>

<p>In-order to create forms, we need to extend <code>Aura\Input\Form</code> class 
and override the <code>init()</code> method.</p>

<p>We use <code>setField</code> method to add an input type.</p>

<p>Let us create an example form</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="kw2">namespace</span> Example\Package\Input<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Aura\Input\Form<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> ContactForm <span class="kw2">extends</span> Form
<span class="br0">&#123;</span>
    <span class="kw2">protected</span> <span class="kw2">function</span> init<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$states</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">&#40;</span>
            <span class="st_h">'AL'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Alabama'</span><span class="sy0">,</span>
            <span class="st_h">'AK'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Alaska'</span><span class="sy0">,</span>
            <span class="st_h">'AZ'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Arizona'</span><span class="sy0">,</span>
            <span class="st_h">'AR'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Arkansas'</span><span class="sy0">,</span>
            <span class="co1">// ...</span>
         <span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// set input fields</span>
        <span class="co1">// hint the view layer to treat the first_name field as a text input,</span>
        <span class="co1">// with size and maxlength attributes</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setField</span><span class="br0">&#40;</span><span class="st_h">'first_name'</span><span class="sy0">,</span> <span class="st_h">'text'</span><span class="br0">&#41;</span>
             <span class="sy0">-&gt;</span><span class="me1">setAttribs</span><span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span>
                <span class="st_h">'size'</span> <span class="sy0">=&gt;</span> <span class="nu0">20</span><span class="sy0">,</span>
                <span class="st_h">'maxlength'</span> <span class="sy0">=&gt;</span> <span class="nu0">20</span><span class="sy0">,</span>
             <span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// hint the view layer to treat the state field as a select, with a </span>
        <span class="co1">// particular set of options (the keys are the option values, and the values</span>
        <span class="co1">// are the displayed text)</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setField</span><span class="br0">&#40;</span><span class="st_h">'state'</span><span class="sy0">,</span> <span class="st_h">'select'</span><span class="br0">&#41;</span>
             <span class="sy0">-&gt;</span><span class="me1">setOptions</span><span class="br0">&#40;</span><span class="re0">$states</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setField</span><span class="br0">&#40;</span><span class="st_h">'message'</span><span class="sy0">,</span> <span class="st_h">'textarea'</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">setAttribs</span><span class="br0">&#40;</span><span class="br0">&#91;</span>
                <span class="st_h">'cols'</span> <span class="sy0">=&gt;</span> <span class="nu0">40</span><span class="sy0">,</span>
                <span class="st_h">'rows'</span> <span class="sy0">=&gt;</span> <span class="nu0">5</span><span class="sy0">,</span>
            <span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="co1">// etc.</span>
&nbsp;
        <span class="co1">// set input filters</span>
        <span class="re0">$filter</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getFilter</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$filter</span><span class="sy0">-&gt;</span><span class="me1">addSoftRule</span><span class="br0">&#40;</span><span class="st_h">'first_name'</span><span class="sy0">,</span> <span class="re0">$filter</span><span class="sy0">::</span><span class="me2">IS</span><span class="sy0">,</span> <span class="st_h">'string'</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$filter</span><span class="sy0">-&gt;</span><span class="me1">addSoftRule</span><span class="br0">&#40;</span><span class="st_h">'first_name'</span><span class="sy0">,</span> <span class="re0">$filter</span><span class="sy0">::</span><span class="me2">IS</span><span class="sy0">,</span> <span class="st_h">'strlenMin'</span><span class="sy0">,</span> <span class="nu0">4</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$filter</span><span class="sy0">-&gt;</span><span class="me1">addSoftRule</span><span class="br0">&#40;</span><span class="st_h">'state'</span><span class="sy0">,</span> <span class="re0">$filter</span><span class="sy0">::</span><span class="me2">IS</span><span class="sy0">,</span> <span class="st_h">'inKeys'</span><span class="sy0">,</span> <span class="re0">$states</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$filter</span><span class="sy0">-&gt;</span><span class="me1">addSoftRule</span><span class="br0">&#40;</span><span class="st_h">'message'</span><span class="sy0">,</span> <span class="re0">$filter</span><span class="sy0">::</span><span class="me2">IS</span><span class="sy0">,</span> <span class="st_h">'string'</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$filter</span><span class="sy0">-&gt;</span><span class="me1">addSoftRule</span><span class="br0">&#40;</span><span class="st_h">'message'</span><span class="sy0">,</span> <span class="re0">$filter</span><span class="sy0">::</span><span class="me2">IS</span><span class="sy0">,</span> <span class="st_h">'strlenMin'</span><span class="sy0">,</span> <span class="nu0">6</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<blockquote>
  <p>Read passing options into forms, to see how the states can also be provided.</p>
</blockquote>

<h2 id="setting-filters-on-the-form">13.2 Setting Filters On The Form</h2>

<p>The aura framework uses Aura.Filter package for form validation and 
sanitization. The <code>Aura\Input\Form</code> object has <code>getFilter()</code> method 
which is an object of <code>Aura\Framework\Input\Filter</code> an extended class of 
<code>Aura\Filter\RuleCollection</code>.</p>

<p>Look into chapter-8 (Validation and Sanitization) for 
the different types of Rules, how you can create your own rules.</p>

<h2 id="configuration-5">13.3 Configuration</h2>

<p>In-order to make use of the dependency injection, we need to map the 
form names to <code>Example\Package\GenericFactory</code>.</p>

<pre><code>[php]
$di-&gt;params['Example\Package\GenericFactory']['map']['form.contact'] = 
    $di-&gt;newFactory('Example\Package\Input\ContactForm');
</code></pre>

<h2 id="form-object">13.4 Form object</h2>

<p>We can create form objects from controller via the <code>Example\Package\GenericFactory</code>
object we injected to the controller as in chapter-6.</p>

<div class="code php">
<pre class="php"><span class="re0">$form</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">factory</span><span class="sy0">-&gt;</span><span class="me1">newInstance</span><span class="br0">&#40;</span><span class="st_h">'form.contact'</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<h2 id="populating-and-validating-user-input">13.5 Populating and Validating User Input</h2>

<p>We can fill the form with user input and see if the user input is valid. 
First, we use the <code>fill()</code> method to set the input values. 
We then call the <code>filter()</code> method to see if the user input is valid; 
if not, we show the messages for the inputs
that did not pass their filter rules.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// fill the form with $_POST array elements</span>
<span class="co1">// that match the form input names.</span>
<span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">fill</span><span class="br0">&#40;</span><span class="re0">$_POST</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// apply the filters</span>
<span class="re0">$pass</span> <span class="sy0">=</span> <span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">filter</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// did all the filters pass?</span>
<span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$pass</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="co1">// yes</span>
    <span class="kw1">echo</span> <span class="st0">&quot;User input is valid.&quot;</span> <span class="sy0">.</span> PHP_EOL<span class="sy0">;</span>
<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
    <span class="co1">// no; get the messages.</span>
    <span class="kw1">echo</span> <span class="st0">&quot;User input is not valid.&quot;</span> <span class="sy0">.</span> PHP_EOL<span class="sy0">;</span>
    <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">getMessages</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">as</span> <span class="re0">$name</span> <span class="sy0">=&gt;</span> <span class="re0">$messages</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$messages</span> <span class="kw1">as</span> <span class="re0">$message</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">echo</span> <span class="st0">&quot;Input '<span class="es4">{$name}</span>': <span class="es4">{$message}</span>&quot;</span> <span class="sy0">.</span> PHP_EOL<span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<h2 id="applying-csrf-protections">13.6 Applying CSRF Protections</h2>

<p>Aura.Input comes with an interface for implementations that prevent
<a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery">cross-site request forgery</a>
attacks.  To make use of this interface, we will need to provide our own
CSRF implementation; this is because it depends on two things that Aura.Input
cannot provide: an object that tells us if the user is authenticated or not,
and an object to generate and retain a crytpographically secure random value
for the CSRF token value.  A psuedo-implementation follows.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="kw2">namespace</span> Example\Package\Input<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Aura\Input\AntiCsrfInterface<span class="sy0">;</span>
<span class="kw2">use</span> Aura\Input\Fieldset<span class="sy0">;</span>
<span class="kw2">use</span> Example\Package\CsrfObject<span class="sy0">;</span>
<span class="kw2">use</span> Example\Package\UserObject<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> AntiCsrf implements AntiCsrfInterface
<span class="br0">&#123;</span>
    <span class="co1">// a user object indicating if the user is authenticated or not</span>
    <span class="kw2">protected</span> <span class="re0">$user</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// a csrf value generation object</span>
    <span class="kw2">protected</span> <span class="re0">$csrf</span><span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> __construct<span class="br0">&#40;</span>UserObject <span class="re0">$user</span><span class="sy0">,</span> CsrfObject <span class="re0">$csrf</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">user</span> <span class="sy0">=</span> <span class="re0">$user</span><span class="sy0">;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">csrf</span> <span class="sy0">=</span> <span class="re0">$csrf</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// implementation of setField(); adds a CSRF token field to the fieldset.</span>
    <span class="kw2">public</span> <span class="kw2">function</span> setField<span class="br0">&#40;</span>Fieldset <span class="re0">$fieldset</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">user</span><span class="sy0">-&gt;</span><span class="me1">isAuthenticated</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="co1">// user is not authenticated so CSRF cannot occur</span>
            <span class="kw1">return</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// user is authenticated, so add a CSRF token</span>
        <span class="re0">$fieldset</span><span class="sy0">-&gt;</span><span class="me1">setField</span><span class="br0">&#40;</span><span class="st_h">'__csrf_token'</span><span class="sy0">,</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">csrf</span><span class="sy0">-&gt;</span><span class="me1">getValue</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// implementation of isValid().  return true if CSRF token is present</span>
    <span class="co1">// and of the correct value, or return false if not.</span>
    <span class="kw2">public</span> <span class="kw2">function</span> isValid<span class="br0">&#40;</span><span class="kw3">array</span> <span class="re0">$data</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">user</span><span class="sy0">-&gt;</span><span class="me1">isAuthenticated</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="co1">// user is not authenticated so CSRF cannot occur</span>
            <span class="kw1">return</span> <span class="kw4">true</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// user is authenticated, so check to see if input has a CSRF token</span>
        <span class="co1">// of the correct value</span>
        <span class="kw1">return</span> <span class="kw3">isset</span><span class="br0">&#40;</span><span class="re0">$data</span><span class="br0">&#91;</span><span class="st_h">'__csrf_token'</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
            <span class="sy0">&amp;&amp;</span> <span class="re0">$data</span><span class="br0">&#91;</span><span class="st_h">'__csrf_token'</span><span class="br0">&#93;</span> <span class="sy0">==</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">csrf</span><span class="sy0">-&gt;</span><span class="me1">getValue</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>We can then pass an instance of the implementation into our form using the
<code>setAntiCsrf()</code> method.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$form</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getFactory</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">newInstance</span><span class="br0">&#40;</span><span class="st_h">'form.contact'</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$anti_csrf</span> <span class="sy0">=</span> <span class="kw2">new</span> AntiCsrf<span class="br0">&#40;</span><span class="kw2">new</span> UserObject<span class="sy0">,</span> <span class="kw2">new</span> CsrfObject<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">setAntiCsrf</span><span class="br0">&#40;</span><span class="re0">$anti_csrf</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Calling <code>setAntiCsrf()</code> adds a CSRF field to the form.</p>

<p>When we call <code>fill()</code> on the form, it will check the CSRF value in the data
to make sure it is correct.  If not, the form will not fill in the data, and
throw an exception and will not fill in the data.</p>

<h2 id="in-the-view-layer">13.7 In The View Layer</h2>

<p>The Aura.Input package only describes the user inputs and their values. It
does not render forms or fields; that task is for the view layer. However,
Aura.Input does allow for "hints" that the view layer can use for rendering.</p>

<p>When defining a field, we can set the type as the second parameter to the
<code>setField()</code> method. This can be an HTML input type, an HTML tag name, a
custom name that the view layer recognizes, or anything else; recall that
these are only hints for the view, and are not strict. In addition, we can use
fluent methods to set attributes and options on the field.</p>

<div class="code php">
<pre class="php"><span class="co1">// hint the view layer to treat the state field as a select, with a </span>
<span class="co1">// particular set of options (the keys are the option values, and the values</span>
<span class="co1">// are the displayed text)</span>
<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setField</span><span class="br0">&#40;</span><span class="st_h">'state'</span><span class="sy0">,</span> <span class="st_h">'select'</span><span class="br0">&#41;</span>
     <span class="sy0">-&gt;</span><span class="me1">setOptions</span><span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span>
        <span class="st_h">'AL'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Alabama'</span><span class="sy0">,</span>
        <span class="st_h">'AK'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Alaska'</span><span class="sy0">,</span>
        <span class="st_h">'AZ'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Arizona'</span><span class="sy0">,</span>
        <span class="st_h">'AR'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Arkansas'</span><span class="sy0">,</span>
        <span class="co1">// ...</span>
     <span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>In our view layer, we can extract the hints for a field using the <code>get()</code>
method.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// get the hints for the state field</span>
<span class="re0">$hints</span> <span class="sy0">=</span> <span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'state'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// the hints array looks like this:</span>
<span class="co1">// $hints = array(</span>
<span class="co1">//     'type' =&gt; 'select',      # the input type</span>
<span class="co1">//     'name' =&gt; 'state',       # the input name</span>
<span class="co1">//     'attribs' =&gt; array(           # attributes as key-value pairs</span>
<span class="co1">//         // ...</span>
<span class="co1">//     ),</span>
<span class="co1">//     'options' =&gt; array(           # options as key-value pairs</span>
<span class="co1">//         'AL' =&gt; 'Alabama',</span>
<span class="co1">//         'AZ' =&gt; 'Arizona',</span>
<span class="co1">//         // ...</span>
<span class="co1">//     ),</span>
<span class="co1">//     'value' =&gt; '',           # the current value of the input</span>
<span class="co1">// );</span></pre>
</div>

<p>The <a href="http://github.com/auraphp/Aura.View">Aura.View</a> package comes with a
series of helpers that can translate the hints array to HTML.</p>

<p>Assuming you have assigned the form object to the view from controller 
action as
    [php]
    $this->data->form = $form;</p>

<p>then from view, you can display the form as</p>

<div class="code php">
<pre class="php"><span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">field</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">form</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'state'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<h2 id="passing-options-into-forms">13.8 Passing Options Into Forms</h2>

<p>Frequently, the application using the inputs will have a standard set of
options used across all forms and filters. It would be inconvenient to have
to duplicate those standard options for each different form, so Aura.Input
allows us to pass in any object at all as a container for application-wide
options.  We can then use those options for building the inputs.</p>

<p>For example, we would construct our <code>ContactForm</code> with an arbitrary options
object ...</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="kw2">namespace</span> Example\Package<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> Options
<span class="br0">&#123;</span>
    <span class="kw2">protected</span> <span class="re0">$states</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">&#40;</span>
        <span class="st_h">'AL'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Alabama'</span><span class="sy0">,</span>
        <span class="st_h">'AK'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Alaska'</span><span class="sy0">,</span>
        <span class="st_h">'AZ'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Arizona'</span><span class="sy0">,</span>
        <span class="st_h">'AR'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Arkansas'</span><span class="sy0">,</span>
        <span class="co1">// ...</span>
    <span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> getStates<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">states</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>... and then use it in the <code>init()</code> method of form remove the <code>$states</code> 
array with <code>$options-&gt;getStates()</code>.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="kw2">namespace</span> Example\Package<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Aura\Input\Form<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> ContactForm <span class="kw2">extends</span> Form
<span class="br0">&#123;</span>
    <span class="kw2">protected</span> <span class="kw2">function</span> init<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="co1">// the options object injected via constructor</span>
        <span class="re0">$options</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getOptions</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="re0">$states</span> <span class="sy0">=</span> <span class="re0">$options</span><span class="sy0">-&gt;</span><span class="me1">getStates</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// set input fields</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setField</span><span class="br0">&#40;</span><span class="st_h">'state'</span><span class="sy0">,</span> <span class="st_h">'select'</span><span class="br0">&#41;</span>
             <span class="sy0">-&gt;</span><span class="me1">setOptions</span><span class="br0">&#40;</span><span class="re0">$states</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<h2 id="configuration-for-options">13.9 Configuration for Options</h2>

<div class="code php">
<pre class="php"><span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">set</span><span class="br0">&#40;</span><span class="st_h">'contact_options'</span><span class="sy0">,</span> <span class="kw2">function</span> <span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw2">use</span> <span class="br0">&#40;</span><span class="re0">$di</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">newInstance</span><span class="br0">&#40;</span><span class="st_h">'Example\Package\Options'</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">params</span><span class="br0">&#91;</span><span class="st_h">'Example\Package\ContactForm'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st_h">'options'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">lazyGet</span><span class="br0">&#40;</span><span class="st_h">'contact_options'</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

    </div>

    <div class="span3">
        <div class="item local_toc">
            <h3>Table of contents</h3>

            <ul class="unstyled">
                                                <li class="level-1">
                        <span></span>
                        <a class="internal" href="./chapter-13.html#creating-forms">Creating Forms</a>
                    </li>
                                    <li class="level-2">
                        <span>13.1</span>
                        <a class="internal" href="./chapter-13.html#form-class">Form class</a>
                    </li>
                                    <li class="level-2">
                        <span>13.2</span>
                        <a class="internal" href="./chapter-13.html#setting-filters-on-the-form">Setting Filters On The Form</a>
                    </li>
                                    <li class="level-2">
                        <span>13.3</span>
                        <a class="internal" href="./chapter-13.html#configuration-5">Configuration</a>
                    </li>
                                    <li class="level-2">
                        <span>13.4</span>
                        <a class="internal" href="./chapter-13.html#form-object">Form object</a>
                    </li>
                                    <li class="level-2">
                        <span>13.5</span>
                        <a class="internal" href="./chapter-13.html#populating-and-validating-user-input">Populating and Validating User Input</a>
                    </li>
                                    <li class="level-2">
                        <span>13.6</span>
                        <a class="internal" href="./chapter-13.html#applying-csrf-protections">Applying CSRF Protections</a>
                    </li>
                                    <li class="level-2">
                        <span>13.7</span>
                        <a class="internal" href="./chapter-13.html#in-the-view-layer">In The View Layer</a>
                    </li>
                                    <li class="level-2">
                        <span>13.8</span>
                        <a class="internal" href="./chapter-13.html#passing-options-into-forms">Passing Options Into Forms</a>
                    </li>
                                    <li class="level-2">
                        <span>13.9</span>
                        <a class="internal" href="./chapter-13.html#configuration-for-options">Configuration for Options</a>
                    </li>
                                        </ul>
        </div>
    </div>
</div>
</div>
</body>
</html>