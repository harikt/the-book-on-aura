<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="author" content="Hari KT, Paul M Jones" />
    <meta name="date" content="07/07/2013"/>
    <meta name="generator" content="easybook 5.0-DEV"/>

    <title>The View | The complete reference for Aura</title>

    <link rel="stylesheet" href="./css/easybook.css" />

</head>

<body class="item chapter">
<div class="container">
<div class="menu">
    <div class="row">
        <h1 class="span9"><a href="./index.html">The complete reference for Aura</a></h1>
        <p class="span3">
                        <a href="./chapter-5.html"><span>&larr;</span> Previous</a>
            
                        <a href="./chapter-7.html">Next <span>&rarr;</span></a>
                    </p>
    </div>
</div>

<div class="row">
    <div class="span9">
        <h1 id="the-view"><span>Chapter 6</span> The View</h1>
        <p>The aura framework make use of Aura.View as the default templating, 
but you can also make use of other templating as done in Hari.Extras.
The Aura View package is an implementation of the
<a href="http://martinfowler.com/eaaCatalog/templateView.html"><code>TemplateView</code></a> pattern,
with support for automatic escaping, path stacks, and helpers. It adheres to
the "use PHP for presentation logic" ideology, and is preceded by systems such
as <a href="http://phpsavant.com"><code>Savant</code></a>,
<a href="http://framework.zend.com/manual/en/zend.view.html"><code>Zend_View</code></a>, and
<a href="http://solarphp.com/class/Solar_View"><code>Solar_View</code></a>.</p>

<h2 id="assigning-data-from-controller">6.1 Assigning Data from controller</h2>

<div class="code php">
<pre class="php"><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">data</span> <span class="sy0">=</span> <span class="br0">&#91;</span>
    <span class="st_h">'foo'</span> <span class="sy0">=&gt;</span> <span class="st_h">'value of foo'</span><span class="sy0">,</span>
    <span class="st_h">'bar'</span> <span class="sy0">=&gt;</span> <span class="st_h">'value of bar'</span><span class="sy0">,</span>
<span class="br0">&#93;</span><span class="sy0">;</span></pre>
</div>

<p>We can then refer to the data as properties from within the template script
using <code>$this</code>:</p>

<div class="code php">
<pre class="php">// template script
<span class="sy1">&lt;?=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">foo</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>
<span class="sy1">&lt;?=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">bar</span><span class="sy0">;</span> <span class="sy1">?&gt;</span></pre>
</div>

<h2 id="writing-template-scripts">6.2 Writing Template Scripts</h2>

<p>Aura View template scripts are written in plain PHP and do not require a new
markup language. The template scripts are executed inside the <code>Template</code>
object scope, so use of <code>$this</code> refers to the <code>Template</code> object. The following
is an example script:</p>

<div class="code php">
<pre class="php">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;<span class="sy1">&lt;?=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">title</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;<span class="sy1">&lt;?=</span> <span class="st0">&quot;Hello &quot;</span> <span class="sy0">.</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="kw2">var</span> <span class="sy0">.</span> <span class="st_h">'!'</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<p>We can use any PHP code we would normally use. (This will require discipline
on the part of the template script author to restrict himself to
presentation-related logic only.)</p>

<p>We may wish to use the alternative PHP syntax for conditionals and loops:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span> <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">model</span><span class="sy0">-&gt;</span><span class="me1">hasMessage</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">:</span> <span class="sy1">?&gt;</span>
    &lt;p&gt;The message is <span class="sy1">&lt;?=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">model</span><span class="sy0">-&gt;</span><span class="me1">getMessage</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>&lt;/p&gt;
<span class="kw2">&lt;?php</span> <span class="kw1">endif</span><span class="sy0">;</span> <span class="sy1">?&gt;</span></pre>
</div>

<div class="code code">
<pre class="code">&lt;ul&gt;
&lt;?php foreach ($this-&gt;list as $item): ?&gt;
    &lt;li&gt;&lt;?= $item; ?&gt;&lt;/li&gt;
&lt;?php endforeach; ?&gt;
&lt;/ul&gt;</pre>
</div>

<h2 id="escaping-output">6.3 Escaping Output</h2>

<p><strong><em>Aura View automatically escapes data assigned to the template when you
access that data.</em></strong> So, in general, you do not need to manually apply escaping
in your template scripts.</p>

<ul>
<li><p>Strings assigned to the template are automatically escaped as you access
them; integers, floats, booleans, and nulls are not.</p></li>
<li><p>If you assign an array to the template, its keys and values will be escaped
as you access them.</p></li>
<li><p>If you assign an object to the template, its properties and method returns
will also be escaped as you access them.</p></li>
</ul>

<p>Here is an example of the business logic to assign data to the template ...</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co4">/**
 * @var object $obj An object with properties and methods.
 * @var array $arr An associative array.
 * @var string $str A string.
 * @var int|float $num An actual number (not a string representation).
 * @var bool $bool A boolean.
 * @var null $null A null value.
 */</span>
<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">data</span> <span class="sy0">=</span> <span class="br0">&#91;</span>
    <span class="st_h">'obj'</span>  <span class="sy0">=&gt;</span> <span class="re0">$obj</span><span class="sy0">,</span>
    <span class="st_h">'arr'</span>  <span class="sy0">=&gt;</span> <span class="re0">$arr</span><span class="sy0">,</span>
    <span class="st_h">'str'</span>  <span class="sy0">=&gt;</span> <span class="re0">$str</span><span class="sy0">,</span>
    <span class="st_h">'num'</span>  <span class="sy0">=&gt;</span> <span class="re0">$num</span><span class="sy0">,</span>
    <span class="st_h">'bool'</span> <span class="sy0">=&gt;</span> <span class="re0">$bool</span><span class="sy0">,</span>
    <span class="st_h">'null'</span> <span class="sy0">=&gt;</span> <span class="kw4">null</span><span class="sy0">,</span>
<span class="br0">&#93;</span><span class="sy0">;</span></pre>
</div>

<p>... and here is an example of the automatic escaping in the template:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// strings are auto-escaped whenever you access them</span>
<span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">str</span><span class="sy0">;</span></pre>
</div>

<div class="code code">
<pre class="code">// integers, floats, booleans, nulls, and resources are not escaped
if ($this-&gt;null === null || $this-&gt;bool === false) {
    echo $this-&gt;num;
}</pre>
</div>

<div class="code code">
<pre class="code">// array keys and values are auto-escaped per the string/number/etc
// rules listed above
foreach ($this-&gt;arr as $key =&gt; $val) {
    // the key and value are already escaped for us
    echo $key . ': ' . $val;
}</pre>
</div>

<div class="code code">
<pre class="code">// object properties and method returns are auto-escaped per the 
// string/number/etc rules listed above
echo $this-&gt;obj-&gt;property;
echo $this-&gt;obj-&gt;method();</pre>
</div>

<div class="code code">
<pre class="code">// if the object implements Iterator or IteratorAggregate,
// the iterator keys and values are auto-escaped as well
foreach ($this-&gt;obj as $key =&gt; $val) {
    echo $key . ': ' . $val;
}</pre>
</div>

<p>Note that automatic escaping occurs at <em>access</em> time, not at <em>assignment</em>
time, and only occurs when accessing <em>values assigned to the template</em>.</p>

<h2 id="manual-escaping">6.4 Manual Escaping</h2>

<p>If you create a variable of your own inside a template, you will need to
escape it yourself using the <code>escape()</code> helper:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$var</span> <span class="sy0">=</span> <span class="st0">&quot;this &amp; that&quot;</span><span class="sy0">;</span>
<span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">escape</span><span class="br0">&#40;</span><span class="re0">$var</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<h2 id="raw-data">6.5 Raw Data</h2>

<p>If you want to access the assigned data without escaping applied, use the
<code>__raw()</code> method:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// get the raw assigned string</span>
<span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span>__raw<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">str</span><span class="sy0">;</span></pre>
</div>

<div class="code code">
<pre class="code">// get the count of an assigned array or object
echo count($this-&gt;__raw()-&gt;arr);</pre>
</div>

<div class="code code">
<pre class="code">// see if the assigned array is empty
if (! $this-&gt;__raw()-&gt;arr) {
    echo &quot;Array is empty.&quot;;
}</pre>
</div>

<div class="code code">
<pre class="code">// get a raw property from an assigned object;
// either of the following will work:
echo $this-&gt;__raw()-&gt;obj-&gt;property;
echo $this-&gt;obj-&gt;__raw()-&gt;property;</pre>
</div>

<div class="code code">
<pre class="code">// get a raw method result from an assigned object;
// either of the following will work:
echo $this-&gt;__raw()-&gt;obj-&gt;method();
echo $this-&gt;obj-&gt;__raw()-&gt;method();</pre>
</div>

<div class="code code">
<pre class="code">// check if an object is an instanceof SomeClass
if ($this-&gt;__raw()-&gt;obj instanceof SomeClass) {
    // ...
}</pre>
</div>

<div class="code code">
<pre class="code">&nbsp;</pre>
</div>

<p>Using the raw data is the only way to get a <code>count()</code> on an array or a
<code>Countable</code> object, or to find the class type of the underlying variable. This
is because the automatic escaping works by wrapping ("decorating") the
underlying variable with an escaper object. The decoration makes it possible
to auto-escape array keys and values, and object properties and methods, but
unfortunately hides things like <code>implements</code> and <code>instanceof</code> from PHP.</p>

<h2 id="double-escaping">6.6 Double Escaping</h2>

<p>There is an escaping "gotcha" to look out for when manipulating values after
they are assigned to a template. If you use an assigned value and re-assign
it to the template, the new value will be double-escaped when you access it.</p>

<p>For example, given this business logic ...</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// business logic</span>
<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">data</span><span class="sy0">-&gt;</span><span class="me1">foo</span> <span class="sy0">=</span> <span class="st0">&quot;this &amp; that&quot;</span><span class="sy0">;</span></pre>
</div>

<div class="code code">
<pre class="code">&nbsp;</pre>
</div>

<p>... and this template script ...</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// template script</span>
<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">bar</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">foo</span> <span class="sy0">.</span> <span class="st0">&quot; &amp; the other&quot;</span><span class="sy0">;</span>
<span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">bar</span><span class="sy0">;</span></pre>
</div>

<p>... the output will be <code>"this &amp;amp;amp; that &amp;amp; the other"</code>. The output was
double-escaped; this is because the template escaped <code>$this-&gt;foo</code> for us when
we accessed it and assigned it to <code>$this-&gt;bar</code>, and then escaped <code>$this-&gt;bar</code>
for output as well.</p>

<p>When performing manipulations of this kind, use the <code>__raw()</code> values instead:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// template script</span>
<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">bar</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span>__raw<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">foo</span> <span class="sy0">.</span> <span class="st0">&quot; &amp; the other&quot;</span><span class="sy0">;</span>
<span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">bar</span><span class="sy0">;</span></pre>
</div>

<p>Now the output will be <code>"this &amp;amp; that &amp;amp; the other"</code>, correctly escaped
only once.</p>

<h2 id="using-helpers">6.7 Using Helpers</h2>

<p>Aura View comes with various <code>Helper</code> classes to encapsulate common
presentation logic. These helpers are mapped to the <code>Template</code> object through
a <code>HelperLocator</code>. We can call a helper in one of two ways:</p>

<ul>
<li><p>As a method on the <code>Template</code> object</p></li>
<li><p>Via <code>getHelper()</code> to get the helper as an object of its own</p></li>
</ul>

<p>We have already discussed the <code>escape()</code> helper above. Other helpers that are
part of Aura View include:</p>

<ul>
<li><p><code>$this-&gt;anchor($href, $text)</code> returns an <code>&lt;a href="$href"&gt;$text&lt;/a&gt;</code> tag</p></li>
<li><p><code>$this-&gt;attribs($list)</code> returns a space-separated attribute list from a
<code>$list</code> key-value pair</p></li>
<li><p><code>$this-&gt;base($href)</code> returns a <code>&lt;base href="$href" /&gt;</code> tag</p></li>
<li><p><code>$this-&gt;datetime($datestr, $format)</code> returns a formatted datetime string.</p></li>
<li><p><code>$this-&gt;image($src)</code> returns an <code>&lt;img src="$src" /&gt;</code> tag.</p></li>
<li><p><code>$this-&gt;input($attribs, $value, $label, $label_attribs)</code> 
returns an <code>&lt;input&gt;</code> tag, optionally wrapped in a <code>&lt;label&gt;</code> tag</p>

<p>In general <code>$this-&gt;input(['type' =&gt; $type], $value, $label, $label_attribs)</code></p>

<p><code>$value</code>, <code>$label</code> and <code>$label_attribs</code> are optional.</p>

<p>Supported types:</p>

<ul>
<li><code>button</code> : clickable button</li>
<li><code>checkbox</code> : checkbox</li>
<li><code>color</code> : color picker</li>
<li><code>date</code> : date control (year, month and day)</li>
<li><code>datetime</code> : date and time control (year, month, day, hour, 
minute, second, and fraction of a second, UTC time zone)</li>
<li><code>datetime-local</code> : date and time control (year, month, day, 
hour, minute, second, and fraction of a second, no time zone)</li>
<li><code>email</code> : e-mail address</li>
<li><code>file</code> : file-select field and a "Browse..." button for file uploads</li>
<li><code>hidden</code> : hidden input field</li>
<li><code>image</code> : image as the submit button</li>
<li><code>month</code> : month and year control (no time zone)</li>
<li><code>number</code> : field for entering a number</li>
<li><code>password</code> : password field</li>
<li><code>radio</code> : radio button</li>
<li><code>range</code> : control for entering a number whose exact value is not 
important (like a slider control)</li>
<li><code>reset</code> : reset button (resets all form values to default values)</li>
<li><code>search</code> : text field for entering a search string</li>
<li><code>submit</code> : submit button</li>
<li><code>tel</code> : telephone number</li>
<li><code>text</code> : (default) single-line text field</li>
<li><code>time</code> : time control (no time zone)</li>
<li><code>url</code> : URL field</li>
<li><code>week</code> : week and year control (no time zone)</li>
</ul>

<p>Examples are</p>

<ul>
<li><p><code>$this-&gt;input(['type' =&gt; 'text', ... ], 'field value')</code></p></li>
<li><p><code>$this-&gt;input(['type' =&gt; 'checkbox', 'value' =&gt; 'yes'], 'yes')</code></p></li>
</ul></li>
<li><p><code>$this-&gt;metas()</code> provides an object with methods that add to, and then
retrieve, a series of <code>&lt;meta ... /&gt;</code> tags.</p></li>
</ul>

<div class="code code">
<pre class="code">- `$this-&gt;metas()-&gt;addHttp($http_equiv, $content)` adds an HTTP-equivalent
  meta tag to the helper.
&nbsp;
- `$this-&gt;metas()-&gt;addName($name, $content)` adds a meta-name tags to the
  helper.
&nbsp;
- `$this-metas()-&gt;get()` returns all the added tags from the helper.</pre>
</div>

<ul>
<li><code>$this-&gt;scripts()</code> provides an object with methods that add to, and then
retrieve, a series of <code>&lt;script ... &gt;&lt;/script&gt;</code> tags.</li>
</ul>

<div class="code code">
<pre class="code">- `$this-&gt;scripts()-&gt;add($src)` adds a script tag to the helper.
&nbsp;
- `$this-&gt;scripts()-&gt;addCond($exp, $src)` adds a script tag inside a
  conditional expression to the helper.
&nbsp;
- `$this-&gt;scripts()-&gt;get()` returns all the added tags from the helper.
&nbsp;</pre>
</div>

<ul>
<li><code>$this-&gt;styles()</code> provides an object with methods that add to, and then
retrieve, a series of <code>&lt;link rel="stylesheet" ... /&gt;</code> tags.</li>
</ul>

<div class="code code">
<pre class="code">- `$this-&gt;styles()-&gt;add($href)` adds a style tag to the helper.
&nbsp;
- `$this-&gt;styles()-&gt;get()` returns all the added tags from the helper.</pre>
</div>

<ul>
<li><p><code>$this-&gt;textarea($attribs, $html)</code> Returns a <code>&lt;textarea&gt;</code>. <code>$html</code> is optional.</p></li>
<li><p><code>$this-&gt;title()</code> provides an object with methods that manipulate the
<code>&lt;title&gt;...&lt;/title&gt;</code> tag.</p></li>
</ul>

<div class="code code">
<pre class="code">- `$this-&gt;title()-&gt;set($title)` sets the title value.
&nbsp;
- `$this-&gt;title()-&gt;append($suffix)` adds on to the end of title value.
&nbsp;
- `$this-&gt;title()-&gt;prepend($prefix)` adds on to the beginning of the title
  value.
&nbsp;
- `$this-&gt;title()-&gt;get()` returns the title tag and value.</pre>
</div>

<h2 id="template-composition">6.8 Template Composition</h2>

<p>It often makes sense to split one template up into multiple pieces. This
allows us to keep logical separations between different pieces of content. We
might have a header section, a navigation section, a sidebar, and so on.</p>

<p>We can use the <code>$this-&gt;find()</code> method in a template script to find a template,
and then <code>include</code> it wherever we like. For example:</p>

<div class="code php">
<pre class="php">&lt;html&gt;
&lt;head&gt;
    <span class="kw2">&lt;?php</span> <span class="kw1">include</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">find</span><span class="br0">&#40;</span><span class="st_h">'head'</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>
&lt;/head&gt;
&lt;body&gt;
    <span class="kw2">&lt;?php</span> <span class="kw1">include</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">find</span><span class="br0">&#40;</span><span class="st_h">'branding'</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>
    <span class="kw2">&lt;?php</span> <span class="kw1">include</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">find</span><span class="br0">&#40;</span><span class="st_h">'navigation'</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>
    &lt;p&gt;Hello, <span class="sy1">&lt;?=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="kw2">var</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>!&lt;/p&gt;
    <span class="kw2">&lt;?php</span> <span class="kw1">include</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">find</span><span class="br0">&#40;</span><span class="st_h">'foot'</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<p>Templates that we <code>include</code> in this way will share the scope of the template
they are included from.</p>

<h2 id="template-partials">6.9 Template Partials</h2>

<p>Template partials are a scope-separated way of splitting up templates. In
doing so, we can pass an array of variables to be used in the partial
template; they will be available under <code>$this</code> <strong>in place of</strong> the parent
template variables. For example, given the following partial template ...</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// partial template named '_item.php'.</span>
<span class="kw1">echo</span> <span class="st0">&quot;    &lt;li&gt;<span class="es4">{$this-&gt;item}</span>&lt;/li&gt;&quot;</span> <span class="sy0">.</span> PHP_EOL<span class="sy0">;</span></pre>
</div>

<p>... we can use it from within another template as a partial:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// main template. assume $this-&gt;list is an array of items.</span>
<span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="kw3">list</span> <span class="kw1">as</span> <span class="re0">$item</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="re0">$template_name</span> <span class="sy0">=</span> <span class="st_h">'_item'</span><span class="sy0">;</span>
    <span class="re0">$template_vars</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="st_h">'item'</span> <span class="sy0">=&gt;</span> <span class="re0">$item</span><span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">partial</span><span class="br0">&#40;</span><span class="re0">$template_name</span><span class="sy0">,</span> <span class="re0">$template_vars</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>That will run the <code>$template_name</code> template script in a separate scope, and
the <code>$template_vars</code> array will be available as <code>$this</code> properties within that
separate scope.</p>

<blockquote>
  <p>N.b.: We can also <code>fetch()</code> other templates from within a template;
  template scripts that are fetched in this way will <em>not</em> share the scope
  of the template they are called from (although <code>$this</code> will still be
  available).</p>
</blockquote>

<h2 id="writing-helpers">6.10 Writing Helpers</h2>

<p>There are two steps to adding new helpers:</p>

<ol>
<li><p>Write a helper class</p></li>
<li><p>Add that class as a service in the <code>HelperLocator</code></p></li>
</ol>

<p>Writing a helper class is straightforward: extend <code>AbstractHelper</code> with an
<code>__invoke()</code> method. The following helper, for example, applies ROT-13 to a
string.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="kw2">namespace</span> Vendor\Package\View\Helper<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Aura\View\Helper\AbstractHelper<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> Obfuscate <span class="kw2">extends</span> AbstractHelper
<span class="br0">&#123;</span>
    <span class="kw2">public</span> <span class="kw2">function</span> __invoke<span class="br0">&#40;</span><span class="re0">$string</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="kw3">str_rot13</span><span class="br0">&#40;</span><span class="re0">$input</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Now that we have a helper class, you can add it as a service in the
<code>HelperLocator</code> like so:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// business logic</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">params</span><span class="br0">&#91;</span><span class="st_h">'Aura\View\HelperLocator'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st_h">'registry'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st_h">'obfuscate'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="kw2">function</span> <span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw2">use</span> <span class="br0">&#40;</span><span class="re0">$di</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">newInstance</span><span class="br0">&#40;</span><span class="st_h">'Vendor\Package\View\Helper\Obfuscate'</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp;</pre>
</div>

<p>The service name in the <code>HelperLocator</code> doubles as a method name on the
<code>Template</code> object. This means we can call the helper via <code>$this-&gt;obfuscate()</code>:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// template script</span>
<span class="kw1">echo</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">obfuscate</span><span class="br0">&#40;</span><span class="st_h">'plain text'</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Note that we can use any method name for the helper, although it is generally
useful to name the service for the helper class.</p>

<p>Please examine the classes in <code>Aura\View\Helper</code> for more complex and powerful
examples.</p>

    </div>

    <div class="span3">
        <div class="item local_toc">
            <h3>Table of contents</h3>

            <ul class="unstyled">
                                                <li class="level-1">
                        <span></span>
                        <a class="internal" href="./chapter-6.html#the-view">The View</a>
                    </li>
                                    <li class="level-2">
                        <span>6.1</span>
                        <a class="internal" href="./chapter-6.html#assigning-data-from-controller">Assigning Data from controller</a>
                    </li>
                                    <li class="level-2">
                        <span>6.2</span>
                        <a class="internal" href="./chapter-6.html#writing-template-scripts">Writing Template Scripts</a>
                    </li>
                                    <li class="level-2">
                        <span>6.3</span>
                        <a class="internal" href="./chapter-6.html#escaping-output">Escaping Output</a>
                    </li>
                                    <li class="level-2">
                        <span>6.4</span>
                        <a class="internal" href="./chapter-6.html#manual-escaping">Manual Escaping</a>
                    </li>
                                    <li class="level-2">
                        <span>6.5</span>
                        <a class="internal" href="./chapter-6.html#raw-data">Raw Data</a>
                    </li>
                                    <li class="level-2">
                        <span>6.6</span>
                        <a class="internal" href="./chapter-6.html#double-escaping">Double Escaping</a>
                    </li>
                                    <li class="level-2">
                        <span>6.7</span>
                        <a class="internal" href="./chapter-6.html#using-helpers">Using Helpers</a>
                    </li>
                                    <li class="level-2">
                        <span>6.8</span>
                        <a class="internal" href="./chapter-6.html#template-composition">Template Composition</a>
                    </li>
                                    <li class="level-2">
                        <span>6.9</span>
                        <a class="internal" href="./chapter-6.html#template-partials">Template Partials</a>
                    </li>
                                    <li class="level-2">
                        <span>6.10</span>
                        <a class="internal" href="./chapter-6.html#writing-helpers">Writing Helpers</a>
                    </li>
                                        </ul>
        </div>
    </div>
</div>
</div>
</body>
</html>