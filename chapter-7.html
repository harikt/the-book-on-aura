<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="author" content="Hari KT, Paul M Jones" />
    <meta name="date" content="07/07/2013"/>
    <meta name="generator" content="easybook 5.0-DEV"/>

    <title>Routing | The complete reference for Aura</title>

    <link rel="stylesheet" href="./css/easybook.css" />

</head>

<body class="item chapter">
<div class="container">
<div class="menu">
    <div class="row">
        <h1 class="span9"><a href="./index.html">The complete reference for Aura</a></h1>
        <p class="span3">
                        <a href="./chapter-6.html"><span>&larr;</span> Previous</a>
            
                        <a href="./chapter-9.html">Next <span>&rarr;</span></a>
                    </p>
    </div>
</div>

<div class="row">
    <div class="span9">
        <h1 id="routing"><span>Chapter 7</span> Routing</h1>
        <p>The routing for the framework is made possible with the help of Aura.Router.
Aura Router is a PHP package that implements web routing. Given a URI path and
a copy of <code>$_SERVER</code>, it will extract controller, action, and parameter values
for a specific application route.</p>

<p>Your application foundation or framework is expected to take the information
provided by the matching route and dispatch to a controller on its own. As
long as your system can provide a URI path string and a representative copy of
<code>$_SERVER</code>, you can use Aura Router.</p>

<p>Aura Router is inspired by <a href="http://solarphp.com/manual/dispatch-cycle.rewrite-rules">Solar rewrite
rules</a> and
<a href="http://routes.groovie.org">http://routes.groovie.org</a>.</p>

<h2 id="adding-a-route">7.1 Adding A Route</h2>

<p>To create a route, call the <code>add()</code> method.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// add a simple named route without params</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'home'</span><span class="sy0">,</span> <span class="st_h">'/'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// add a simple unnamed route with params</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="kw4">null</span><span class="sy0">,</span> <span class="st_h">'/{:controller}/{:action}/{:id:(\d+)}'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// add a complex named route</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'read'</span><span class="sy0">,</span> <span class="st_h">'/blog/read/{:id}{:format}'</span><span class="sy0">,</span> <span class="br0">&#91;</span>
    <span class="st_h">'params'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'id'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'(\d+)'</span><span class="sy0">,</span>
        <span class="st_h">'format'</span> <span class="sy0">=&gt;</span> <span class="st_h">'(\..+)?'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
    <span class="st_h">'values'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'controller'</span> <span class="sy0">=&gt;</span> <span class="st_h">'blog'</span><span class="sy0">,</span>
        <span class="st_h">'action'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'read'</span><span class="sy0">,</span>
        <span class="st_h">'format'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'html'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<h2 id="generating-a-route-path">7.2 Generating A Route Path</h2>

<h3 id="inside-controller">7.2.1 Inside Controller</h3>

<p>To generate a URI path from a route so that you can create links, call
<code>generate()</code> on the router object and provide the route name.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="co1">// $path =&gt; &quot;/blog/read/42.atom&quot;</span>
<span class="re0">$path</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">router</span><span class="sy0">-&gt;</span><span class="me1">generate</span><span class="br0">&#40;</span><span class="st_h">'read'</span><span class="sy0">,</span> <span class="br0">&#91;</span>
    <span class="st_h">'id'</span> <span class="sy0">=&gt;</span> <span class="nu0">42</span><span class="sy0">,</span>
    <span class="st_h">'format'</span> <span class="sy0">=&gt;</span> <span class="st_h">'.atom'</span><span class="sy0">,</span>
<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Aura Router does not do dynamic matching of routes; a route must have a name
to be able to generate a path from it.</p>

<p>The example shows that passing an array of data as the second parameter will
cause that data to be interpolated into the route path. This data array is
optional. If there are path params without matching data keys, those params
will <em>not</em> be replaced, leaving the <code>{:param}</code> token in the path. If there are
data keys without matching params, those values will not be added to the path.</p>

<h2 id="advanced-usage">7.3 Advanced Usage</h2>

<h2 id="complex-route-specification">7.4 Complex Route Specification</h2>

<p>When you add a complex route specification, you describe extra information
related to the path as an array with one or more of the following recognized
keys:</p>

<ul>
<li><p><code>params</code> -- The regular expression subpatterns for path params; inline 
params will override these settings. For example:</p>

<pre><code>'params' =&gt; [
    'id' =&gt; '(\d+)',
]
</code></pre>

<p>Note that the path itself is allowed to contain param tokens with inline 
regular expressions; e.g., <code>/read/{:id:(\d+)}</code>.  This may be easier to read in some cases.</p></li>
<li><p><code>values</code> -- The default values for the route. These will be overwritten 
by matching params from the path.</p></li>
</ul>

<div class="code code">
<pre class="code">    'values' =&gt; [
        'controller' =&gt; 'blog',
        'action' =&gt; 'read',
        'id' =&gt; 1,
    ]
&nbsp;</pre>
</div>

<ul>
<li><p><code>method</code> -- The <code>$server['REQUEST_METHOD']</code> must match one of these values.</p></li>
<li><p><code>secure</code> -- When <code>true</code> the <code>$server['HTTPS']</code> value must be on, or the 
request must be on port 443; when <code>false</code>, neither of those must be in place.</p></li>
<li><p><code>routable</code> -- When <code>false</code> the route will not be used for matching, 
only for generating paths.</p></li>
<li><p><code>is_match</code> -- A custom callback or closure with the signature 
<code>function(array $server, \ArrayObject $matches)</code> that returns true on a 
match, or false if not. This allows developers to build any kind of matching 
logic for the route, and to change the <code>$matches</code> for param values from the path.</p></li>
<li><p><code>generate</code> -- A custom callback or closure with the signature 
<code>function(\aura\router\Route $route, array $data)</code> that returns a modified 
<code>$data</code> array to be used when generating the path.</p></li>
</ul>

<p>Here is a full route specification named <code>read</code> with all keys in place:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'read'</span><span class="sy0">,</span> <span class="st_h">'/blog/read/{:id}{:format}'</span><span class="sy0">,</span> <span class="br0">&#91;</span>
    <span class="st_h">'params'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'id'</span> <span class="sy0">=&gt;</span> <span class="st_h">'(\d+)'</span><span class="sy0">,</span>
        <span class="st_h">'format'</span> <span class="sy0">=&gt;</span> <span class="st_h">'(\..+)?'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
    <span class="st_h">'values'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'controller'</span> <span class="sy0">=&gt;</span> <span class="st_h">'blog'</span><span class="sy0">,</span>
        <span class="st_h">'action'</span> <span class="sy0">=&gt;</span> <span class="st_h">'read'</span><span class="sy0">,</span>
        <span class="st_h">'id'</span> <span class="sy0">=&gt;</span> <span class="nu0">1</span><span class="sy0">,</span>
        <span class="st_h">'format'</span> <span class="sy0">=&gt;</span> <span class="st_h">'.html'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
    <span class="st_h">'secure'</span> <span class="sy0">=&gt;</span> <span class="kw4">false</span><span class="sy0">,</span>
    <span class="st_h">'method'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span><span class="st_h">'GET'</span><span class="br0">&#93;</span><span class="sy0">,</span>
    <span class="st_h">'routable'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="sy0">,</span>
    <span class="st_h">'is_match'</span> <span class="sy0">=&gt;</span> <span class="kw2">function</span><span class="br0">&#40;</span><span class="kw3">array</span> <span class="re0">$server</span><span class="sy0">,</span> \ArrayObject <span class="re0">$matches</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
        <span class="co1">// disallow matching if referred from example.com</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$server</span><span class="br0">&#91;</span><span class="st_h">'HTTP_REFERER'</span><span class="br0">&#93;</span> <span class="sy0">==</span> <span class="st_h">'http://example.com'</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// add the referer from $server to the match values</span>
        <span class="re0">$matches</span><span class="br0">&#91;</span><span class="st_h">'referer'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="re0">$server</span><span class="br0">&#91;</span><span class="st_h">'HTTP_REFERER'</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw4">true</span><span class="sy0">;</span>
&nbsp;
    <span class="br0">&#125;</span><span class="sy0">,</span>
    <span class="st_h">'generate'</span> <span class="sy0">=&gt;</span> <span class="kw2">function</span><span class="br0">&#40;</span>\Aura\Router\Route <span class="re0">$route</span><span class="sy0">,</span> <span class="kw3">array</span> <span class="re0">$data</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="re0">$data</span><span class="br0">&#91;</span><span class="st_h">'foo'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="st_h">'bar'</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="re0">$data</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Note that using closures, instead of callbacks, means you will not be able to
<code>serialize()</code> or <code>var_export()</code> the router for caching.</p>

<h2 id="simple-routes">7.5 Simple Routes</h2>

<p>You don't need to specify a complex route specification. If you pass a string
for the route instead of an array ...</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'archive'</span><span class="sy0">,</span> <span class="st_h">'/archive/{:year}/{:month}/{:day}'</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>... then Aura Router will use a default subpattern that matches everything
except slashes for the path params, and use the route name as the default
value for <code>'action'</code>. Thus, the above short-form route is equivalent to the
following long-form route:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'archive'</span><span class="sy0">,</span> <span class="st_h">'/archive/{:year}/{:month}/{:day}'</span><span class="sy0">,</span> <span class="br0">&#91;</span>
    <span class="st_h">'params'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'year'</span>  <span class="sy0">=&gt;</span> <span class="st_h">'([^/]+)'</span><span class="sy0">,</span>
        <span class="st_h">'month'</span> <span class="sy0">=&gt;</span> <span class="st_h">'([^/]+)'</span><span class="sy0">,</span>
        <span class="st_h">'day'</span>   <span class="sy0">=&gt;</span> <span class="st_h">'([^/]+)'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
    <span class="st_h">'values'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'action'</span> <span class="sy0">=&gt;</span> <span class="st_h">'archive'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<h2 id="wildcard-routes">7.6 Wildcard Routes</h2>

<p>Sometimes it is useful to allow the trailing part of the path be anything at
all. There are two types of such "wildcard" routes. (Wildcard routing of this
sort works only when specified at the end of the path.)</p>

<p>The first is a "values optional" named wildcard, represented by adding
<code>/{:foo*}</code> to the end of the path. This will allow the route to match
anything after that point, including nothing at all. On a match, it will
collect the remaining slash-separated values into a sequential array named
<code>'foo'</code>. Notably, the matched path with no wildcard values may have a slash at
the end or not.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'wild_post'</span><span class="sy0">,</span> <span class="st_h">'/post/{:id}/{:other*}'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// this matches, with the following values</span>
<span class="re0">$route</span> <span class="sy0">=</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">match</span><span class="br0">&#40;</span><span class="st_h">'/post/88/foo/bar/baz'</span><span class="sy0">,</span> <span class="re0">$_SERVER</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// $route-&gt;values['id'] = 88;</span>
<span class="co1">// $route-&gt;values['other'] = ['foo', 'bar', 'baz'];</span>
&nbsp;
<span class="co1">// this also matches, with the following values; note the trailing slash</span>
<span class="re0">$route</span> <span class="sy0">=</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">match</span><span class="br0">&#40;</span><span class="st_h">'/post/88/'</span><span class="sy0">,</span> <span class="re0">$_SERVER</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// $route-&gt;values['id'] = 88;</span>
<span class="co1">// $route-&gt;values['other'] = [];</span>
&nbsp;
<span class="co1">// this also matches, with the following values; note the missing slash</span>
<span class="re0">$route</span> <span class="sy0">=</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">match</span><span class="br0">&#40;</span><span class="st_h">'/post/88'</span><span class="sy0">,</span> <span class="re0">$_SERVER</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// $route-&gt;values['id'] = 88;</span>
<span class="co1">// $route-&gt;values['other'] = [];</span></pre>
</div>

<p>The second is a "values required" wildcard, represented by adding <code>/{:foo+}</code>
to the end of the path. This will allow the route to match anything at all
after that point, but there must be at least one slash and an additional
value. On a match, it will collect the remaining slash-separated values into a
sequential array named <code>'foo'</code>.</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'wild_post'</span><span class="sy0">,</span> <span class="st_h">'/post/{:id}/{:other+}'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// this matches, with the following values</span>
<span class="re0">$route</span> <span class="sy0">=</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">match</span><span class="br0">&#40;</span><span class="st_h">'/post/88/foo/bar/baz'</span><span class="sy0">,</span> <span class="re0">$_SERVER</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// $route-&gt;values['id'] = 88;</span>
<span class="co1">// $route-&gt;values['other'] = ['foo', 'bar', 'baz'];</span>
&nbsp;
<span class="co1">// these do not match</span>
<span class="re0">$route</span> <span class="sy0">=</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">match</span><span class="br0">&#40;</span><span class="st_h">'/post/88/'</span><span class="sy0">,</span> <span class="re0">$_SERVER</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$route</span> <span class="sy0">=</span> <span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">match</span><span class="br0">&#40;</span><span class="st_h">'/post/88'</span><span class="sy0">,</span> <span class="re0">$_SERVER</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<blockquote>
  <p>N.b.: In previous releases of the router, <code>'/*'</code> was the wildcard
  indicator, with wildcard values collected in an array named <code>'*'</code>. This
  behavior remains available but is deprecated.</p>
</blockquote>

<h2 id="attaching-route-groups">7.7 Attaching Route Groups</h2>

<p>You can add a series of routes all at once under a single "mount point" in
your application. For example, if you want all your blog-related routes to be
mounted at <code>'/blog'</code> in your application, you can do this:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">attach</span><span class="br0">&#40;</span><span class="st_h">'/blog'</span><span class="sy0">,</span> <span class="br0">&#91;</span>
&nbsp;
    <span class="co1">// the routes to attach</span>
    <span class="st_h">'routes'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
&nbsp;
        <span class="co1">// a short-form route named 'browse'</span>
        <span class="st_h">'browse'</span> <span class="sy0">=&gt;</span> <span class="st_h">'/'</span><span class="sy0">,</span>
&nbsp;
        <span class="co1">// a long-form route named 'read'</span>
        <span class="st_h">'read'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
            <span class="st_h">'path'</span> <span class="sy0">=&gt;</span> <span class="st_h">'/{:id}{:format}'</span><span class="sy0">,</span>
            <span class="st_h">'params'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
                <span class="st_h">'id'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'(\d+)'</span><span class="sy0">,</span>
                <span class="st_h">'format'</span> <span class="sy0">=&gt;</span> <span class="st_h">'(\.json|\.atom)?'</span>
            <span class="br0">&#93;</span><span class="sy0">,</span>
            <span class="st_h">'values'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
                <span class="st_h">'format'</span> <span class="sy0">=&gt;</span> <span class="st_h">'.html'</span><span class="sy0">,</span>
            <span class="br0">&#93;</span><span class="sy0">,</span>
        <span class="br0">&#93;</span><span class="sy0">,</span>
&nbsp;
        <span class="co1">// a short-form route named 'edit'</span>
        <span class="st_h">'edit'</span> <span class="sy0">=&gt;</span> <span class="st_h">'/{:id:(\d+)}/edit'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<div class="code code">
<pre class="code">&nbsp;</pre>
</div>

<p>Each of the route paths will be prefixed with <code>/blog</code>, so the effective paths
become:</p>

<ul>
<li><code>browse: /blog/</code></li>
<li><code>read:   /blog/{:id}{:format}</code></li>
<li><code>edit:   /blog/{:id}/edit</code></li>
</ul>

<p>You can set other route specification keys as part of the attachment
specification; these will be used as the defaults for each attached route, so
you don't need to repeat common information:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
<span class="re0">$di</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'router_map'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">attach</span><span class="br0">&#40;</span><span class="st_h">'/blog'</span><span class="sy0">,</span> <span class="br0">&#91;</span>
&nbsp;
    <span class="co1">// common params for the routes</span>
    <span class="st_h">'params'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'id'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'(\d+)'</span><span class="sy0">,</span>
        <span class="st_h">'format'</span> <span class="sy0">=&gt;</span> <span class="st_h">'(\.json|\.atom)?'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
&nbsp;
    <span class="co1">// common values for the routes</span>
    <span class="st_h">'values'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'controller'</span> <span class="sy0">=&gt;</span> <span class="st_h">'blog'</span><span class="sy0">,</span>
        <span class="st_h">'format'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'.html'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
&nbsp;
    <span class="co1">// the routes to attach</span>
    <span class="st_h">'routes'</span> <span class="sy0">=&gt;</span> <span class="br0">&#91;</span>
        <span class="st_h">'browse'</span> <span class="sy0">=&gt;</span> <span class="st_h">'/'</span><span class="sy0">,</span>
        <span class="st_h">'read'</span>   <span class="sy0">=&gt;</span> <span class="st_h">'/{:id}{:format}'</span><span class="sy0">,</span>
        <span class="st_h">'edit'</span>   <span class="sy0">=&gt;</span> <span class="st_h">'/{:id}/edit'</span><span class="sy0">,</span>
    <span class="br0">&#93;</span><span class="sy0">,</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

    </div>

    <div class="span3">
        <div class="item local_toc">
            <h3>Table of contents</h3>

            <ul class="unstyled">
                                                <li class="level-1">
                        <span></span>
                        <a class="internal" href="./71.html#routing">Routing</a>
                    </li>
                                    <li class="level-2">
                        <span>7.1</span>
                        <a class="internal" href="./71.html#adding-a-route">Adding A Route</a>
                    </li>
                                    <li class="level-2">
                        <span>7.2</span>
                        <a class="internal" href="./71.html#generating-a-route-path">Generating A Route Path</a>
                    </li>
                                    <li class="level-2">
                        <span>7.3</span>
                        <a class="internal" href="./71.html#advanced-usage">Advanced Usage</a>
                    </li>
                                    <li class="level-2">
                        <span>7.4</span>
                        <a class="internal" href="./71.html#complex-route-specification">Complex Route Specification</a>
                    </li>
                                    <li class="level-2">
                        <span>7.5</span>
                        <a class="internal" href="./71.html#simple-routes">Simple Routes</a>
                    </li>
                                    <li class="level-2">
                        <span>7.6</span>
                        <a class="internal" href="./71.html#wildcard-routes">Wildcard Routes</a>
                    </li>
                                    <li class="level-2">
                        <span>7.7</span>
                        <a class="internal" href="./71.html#attaching-route-groups">Attaching Route Groups</a>
                    </li>
                                        </ul>
        </div>
    </div>
</div>
</div>
</body>
</html>